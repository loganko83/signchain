import{j as e}from"./ui-vendor-DtKnxXw5.js";import{r as h}from"./react-vendor-Dzt9N-8P.js";import{b as V,u as se}from"./api-D30H7COj.js";import{B as Be,W as Ne,N as ye,D as He,a as Le,b as ze,c as J,d as Ue}from"./navigation-5OFf-6VJ.js";import{c as le,f as xe,C as y,d as O,e as B,F as Z,a as b,B as x,S as be,A as de,h as me,i as Ve,j as v,I as _,q as G,g as Se,u as Ye}from"./index-DifXOlZV.js";import{B as P}from"./badge-rnGWDgP8.js";import{S as he}from"./separator-Dzupzyuf.js";import{D as Te,T as Qe}from"./trash-2-Z6SvuD8n.js";import{E as Xe}from"./external-link-BWsmJ6ag.js";import{U as z}from"./users-Dfgh8Ec7.js";import{C as De}from"./circle-check-big-DmYyX7eJ.js";import{C as Y}from"./clock-DuONhkx9.js";import{H as Je}from"./index-BKvQmfCR.js";import{u as Ze,C as Ge,U as es}from"./auth-CrUQ8IGp.js";import{d as oe,e as H,g as ss,h as L,D as qe,a as Fe,b as Me,c as Re,S as Ae,f as ts}from"./format-DX_9SH_Z.js";import{S as ee,T as Ie,P as te}from"./switch-DBJrgJkF.js";import{P as as,a as rs,b as is}from"./popover-Bj6eD1N0.js";import{S as ae,a as re,b as ie,c as ne,d as p}from"./select-hc7DGu3L.js";import{T as ns,a as ls,b as ke,c as Ce}from"./tabs-dCtZTWem.js";import{S as Ke}from"./settings-ZoGiSStI.js";import{C as Oe,E as cs}from"./eye-C9NA_Jtt.js";import{F as _e}from"./file-pen-line-BZ6ZTl2k.js";import{C as os}from"./calendar-69kh2sSq.js";import{C as ds}from"./circle-alert-Dm7xIx_l.js";import{S as ms}from"./search-CuHUokbq.js";import{F as hs}from"./funnel-x0MrzwAy.js";import"./chevron-right-BvkGw-1c.js";import"./check-De_5ApH_.js";import"./scroll-area-DphmFSKC.js";import"./mail-QB_YH95i.js";import"./triangle-alert-Bm8XEbEZ.js";import"./user-BSnMhyMb.js";import"./menu-BmVmghho.js";import"./square-check-big-C70hS6gv.js";import"./user-check-DLYaMNIv.js";import"./code-CWGiOtEZ.js";import"./utils-B2rm_Apj.js";import"./schema-EHrJC5zW.js";import"./chevron-left-DdawmFZq.js";import"./index-DPahxWVS.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],us=le("arrow-down",xs);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],ps=le("arrow-up",js);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m5 12-3 3 3 3",key:"oke12k"}],["path",{d:"m9 18 3-3-3-3",key:"112psh"}]],Pe=le("file-code-2",gs);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],vs=le("file-down",fs),ws={lessThanXSeconds:{one:"1초 미만",other:"{{count}}초 미만"},xSeconds:{one:"1초",other:"{{count}}초"},halfAMinute:"30초",lessThanXMinutes:{one:"1분 미만",other:"{{count}}분 미만"},xMinutes:{one:"1분",other:"{{count}}분"},aboutXHours:{one:"약 1시간",other:"약 {{count}}시간"},xHours:{one:"1시간",other:"{{count}}시간"},xDays:{one:"1일",other:"{{count}}일"},aboutXWeeks:{one:"약 1주",other:"약 {{count}}주"},xWeeks:{one:"1주",other:"{{count}}주"},aboutXMonths:{one:"약 1개월",other:"약 {{count}}개월"},xMonths:{one:"1개월",other:"{{count}}개월"},aboutXYears:{one:"약 1년",other:"약 {{count}}년"},xYears:{one:"1년",other:"{{count}}년"},overXYears:{one:"1년 이상",other:"{{count}}년 이상"},almostXYears:{one:"거의 1년",other:"거의 {{count}}년"}},Ns=(s,r,l)=>{let c;const u=ws[s];return typeof u=="string"?c=u:r===1?c=u.one:c=u.other.replace("{{count}}",r.toString()),l!=null&&l.addSuffix?l.comparison&&l.comparison>0?c+" 후":c+" 전":c},ys={full:"y년 M월 d일 EEEE",long:"y년 M월 d일",medium:"y.MM.dd",short:"y.MM.dd"},bs={full:"a H시 mm분 ss초 zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Ss={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},ks={date:oe({formats:ys,defaultWidth:"full"}),time:oe({formats:bs,defaultWidth:"full"}),dateTime:oe({formats:Ss,defaultWidth:"full"})},Cs={lastWeek:"'지난' eeee p",yesterday:"'어제' p",today:"'오늘' p",tomorrow:"'내일' p",nextWeek:"'다음' eeee p",other:"P"},Ps=(s,r,l,c)=>Cs[s],Es={narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["기원전","서기"]},Ts={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1분기","2분기","3분기","4분기"]},Ds={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],wide:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"]},qs={narrow:["일","월","화","수","목","금","토"],short:["일","월","화","수","목","금","토"],abbreviated:["일","월","화","수","목","금","토"],wide:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"]},Fs={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},Ms={narrow:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},abbreviated:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"},wide:{am:"오전",pm:"오후",midnight:"자정",noon:"정오",morning:"아침",afternoon:"오후",evening:"저녁",night:"밤"}},Rs=(s,r)=>{const l=Number(s);switch(String(r==null?void 0:r.unit)){case"minute":case"second":return String(l);case"date":return l+"일";default:return l+"번째"}},As={ordinalNumber:Rs,era:H({values:Es,defaultWidth:"wide"}),quarter:H({values:Ts,defaultWidth:"wide",argumentCallback:s=>s-1}),month:H({values:Ds,defaultWidth:"wide"}),day:H({values:qs,defaultWidth:"wide"}),dayPeriod:H({values:Fs,defaultWidth:"wide",formattingValues:Ms,defaultFormattingWidth:"wide"})},Is=/^(\d+)(일|번째)?/i,Ks=/\d+/i,Os={narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(기원전|서기)/i},_s={any:[/^(bc|기원전)/i,/^(ad|서기)/i]},Ws={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]사?분기/i},$s={any:[/1/i,/2/i,/3/i,/4/i]},Bs={narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])월/i,wide:/^(1[012]|[123456789])월/i},Hs={any:[/^1월?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},Ls={narrow:/^[일월화수목금토]/,short:/^[일월화수목금토]/,abbreviated:/^[일월화수목금토]/,wide:/^[일월화수목금토]요일/},zs={any:[/^일/,/^월/,/^화/,/^수/,/^목/,/^금/,/^토/]},Us={any:/^(am|pm|오전|오후|자정|정오|아침|저녁|밤)/i},Vs={any:{am:/^(am|오전)/i,pm:/^(pm|오후)/i,midnight:/^자정/i,noon:/^정오/i,morning:/^아침/i,afternoon:/^오후/i,evening:/^저녁/i,night:/^밤/i}},Ys={ordinalNumber:ss({matchPattern:Is,parsePattern:Ks,valueCallback:s=>parseInt(s,10)}),era:L({matchPatterns:Os,defaultMatchWidth:"wide",parsePatterns:_s,defaultParseWidth:"any"}),quarter:L({matchPatterns:Ws,defaultMatchWidth:"wide",parsePatterns:$s,defaultParseWidth:"any",valueCallback:s=>s+1}),month:L({matchPatterns:Bs,defaultMatchWidth:"wide",parsePatterns:Hs,defaultParseWidth:"any"}),day:L({matchPatterns:Ls,defaultMatchWidth:"wide",parsePatterns:zs,defaultParseWidth:"any"}),dayPeriod:L({matchPatterns:Us,defaultMatchWidth:"any",parsePatterns:Vs,defaultParseWidth:"any"})},Qs={code:"ko",formatDistance:Ns,formatLong:ks,formatRelative:Ps,localize:As,match:Ys,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Xs({document:s}){const[r,l]=h.useState(!1),{toast:c}=xe(),{data:u=[]}=V({queryKey:["/api/signatures",s.id],queryFn:async()=>{const i=await fetch(`/api/signatures?documentId=${s.id}`);if(!i.ok)throw new Error("서명 정보를 가져올 수 없습니다");return i.json()}}),{data:S=[]}=V({queryKey:["/api/audit",s.id],queryFn:async()=>{const i=await fetch(`/api/audit/${s.id}`);if(!i.ok)throw new Error("감사 로그를 가져올 수 없습니다");return i.json()}}),E=se({mutationFn:async()=>Ve(`/api/verify/${s.id}`,"POST"),onSuccess:i=>{c({title:"블록체인 검증 완료",description:i.isValid?"문서가 블록체인에서 성공적으로 검증되었습니다.":"문서 검증에 실패했습니다."})},onError:()=>{c({title:"검증 실패",description:"블록체인 검증 중 오류가 발생했습니다.",variant:"destructive"})}}),T=()=>{const i=globalThis.document.createElement("a");i.href=`data:application/pdf;base64,${btoa("Mock PDF content for "+s.title)}`,i.download=s.title+".pdf",i.click(),c({title:"다운로드 시작",description:`${s.title} 파일 다운로드를 시작합니다.`})},M=async()=>{l(!0);try{await E.mutateAsync()}finally{l(!1)}},m=i=>{switch(i){case"서명 완료":return"bg-green-100 text-green-800";case"서명 대기":return"bg-yellow-100 text-yellow-800";case"업로드됨":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5"}),s.title]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["업로드: ",s.createdAt?new Date(s.createdAt).toLocaleString("ko-KR"):""]})]}),e.jsx(P,{className:m(s.status),children:s.status})]})}),e.jsxs(b,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"파일 타입"}),e.jsx("p",{className:"text-sm",children:s.fileType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"파일 크기"}),e.jsx("p",{className:"text-sm",children:s.fileSize?`${Math.round(s.fileSize/1024)} KB`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"IPFS 해시"}),e.jsx("p",{className:"text-xs font-mono bg-gray-100 p-1 rounded",children:s.ipfsHash})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"파일 해시"}),e.jsx("p",{className:"text-xs font-mono bg-gray-100 p-1 rounded",children:s.fileHash})]})]}),e.jsx(he,{className:"my-4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{onClick:T,variant:"outline",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"다운로드"]}),e.jsxs(x,{onClick:M,variant:"outline",disabled:r,children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),r?"검증 중...":"블록체인 검증"]}),s.blockchainTxHash&&e.jsx(x,{variant:"outline",asChild:!0,children:e.jsxs("a",{href:`https://explorer.xphere.io/tx/${s.blockchainTxHash}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"블록체인 탐색기"]})})]})]})]}),e.jsxs(y,{children:[e.jsx(O,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"디지털 서명 (",u.length,")"]})}),e.jsx(b,{children:u.length>0?e.jsx("div",{className:"space-y-4",children:u.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(De,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:i.signerEmail}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.signedAt?new Date(i.signedAt).toLocaleString("ko-KR"):""})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs(P,{variant:"outline",className:"bg-green-50 text-green-700",children:[e.jsx(Be,{className:"h-3 w-3 mr-1"}),"검증됨"]}),i.blockchainTxHash&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1 font-mono",children:[i.blockchainTxHash.slice(0,12),"..."]})]})]},i.id))}):e.jsxs(de,{children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx(me,{children:"아직 서명이 완료되지 않았습니다."})]})})]}),s.blockchainTxHash&&e.jsxs(y,{children:[e.jsx(O,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"블록체인 정보"]})}),e.jsx(b,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"트랜잭션 해시"}),e.jsx("p",{className:"text-xs font-mono bg-gray-100 p-2 rounded",children:s.blockchainTxHash})]}),e.jsxs(de,{className:"bg-green-50 border-green-200",children:[e.jsx(be,{className:"h-4 w-4 text-green-600"}),e.jsx(me,{className:"text-green-800",children:"이 문서는 Xphere 블록체인에 영구적으로 기록되어 변조가 불가능합니다."})]})]})})]}),e.jsxs(y,{children:[e.jsx(O,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"감사 추적 (",S.length,")"]})}),e.jsx(b,{children:S.length>0?e.jsx("div",{className:"space-y-3",children:S.map(i=>e.jsxs("div",{className:"flex items-start gap-3 p-3 border-l-2 border-blue-200 bg-blue-50",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-medium text-sm",children:i.action}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i.timestamp?new Date(i.timestamp).toLocaleString("ko-KR"):""})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:i.description}),i.ipAddress&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["IP: ",i.ipAddress]})]})]},i.id))}):e.jsx("p",{className:"text-muted-foreground",children:"감사 로그가 없습니다."})})]})]})}const Js=h.createContext(void 0),U=class U{static getToken(){return localStorage.getItem(this.TOKEN_KEY)}static setToken(r){localStorage.setItem(this.TOKEN_KEY,r)}static getRefreshToken(){return localStorage.getItem(this.REFRESH_TOKEN_KEY)}static setRefreshToken(r){localStorage.setItem(this.REFRESH_TOKEN_KEY,r)}static getUser(){const r=localStorage.getItem(this.USER_KEY);if(!r)return null;try{return JSON.parse(r)}catch{return null}}static setUser(r){localStorage.setItem(this.USER_KEY,JSON.stringify(r))}static clearAll(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.REFRESH_TOKEN_KEY),localStorage.removeItem(this.USER_KEY)}static isTokenExpired(r){try{const l=JSON.parse(atob(r.split(".")[1])),c=Date.now()/1e3;return l.exp<c}catch{return!0}}};U.TOKEN_KEY="signchain_token",U.REFRESH_TOKEN_KEY="signchain_refresh_token",U.USER_KEY="signchain_user";let Q=U;const ue=class ue{static async login(r,l,c=!1){return(await fetch(`${this.BASE_URL}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:l,rememberMe:c})})).json()}static async refreshToken(r){return(await fetch(`${this.BASE_URL}/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:r})})).json()}static async logout(){const r=Q.getToken();r&&await fetch(`${this.BASE_URL}/logout`,{method:"POST",headers:{Authorization:`Bearer ${r}`}})}static async getCurrentUser(){const r=Q.getToken();return r?(await fetch(`${this.BASE_URL}/me`,{headers:{Authorization:`Bearer ${r}`}})).json():{success:!1,error:"No token found"}}};ue.BASE_URL="/api/auth";let Ee=ue;const Zs=()=>{const s=h.useContext(Js);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s},We=async(s,r={})=>{const l=Q.getToken(),c={"Content-Type":"application/json",...r.headers};return l&&(c.Authorization=`Bearer ${l}`),fetch(s,{...r,headers:c})};function Gs({documentId:s,open:r,onOpenChange:l,onWorkflowCreated:c}){const{getCurrentUserId:u}=Zs(),[S,E]=h.useState(""),[T,M]=h.useState(""),[m,i]=h.useState([]),[k,A]=h.useState(!0),{toast:C}=xe();V({queryKey:["/api/workflow-templates"],queryFn:async()=>{const t=await fetch("/api/workflow-templates");if(!t.ok)throw new Error("템플릿을 가져올 수 없습니다");return t.json()}});const D=se({mutationFn:async t=>{const g=await We("/api/workflow-templates",{method:"POST",body:JSON.stringify(t)});if(!g.ok)throw new Error("워크플로우 생성에 실패했습니다");return g.json()},onSuccess:t=>{C({title:"워크플로우 생성 완료",description:"새로운 협업 워크플로우가 생성되었습니다."}),G.invalidateQueries({queryKey:["/api/workflow-templates"]}),c==null||c(t.id),n(),l(!1)},onError:t=>{C({title:"오류",description:"워크플로우 생성 중 오류가 발생했습니다.",variant:"destructive"})}}),W=()=>{const t={id:Date.now().toString(),type:"signer",email:"",name:"",order:m.length+1,isRequired:!0,allowParallel:!k};i([...m,t])},f=(t,g)=>{i(m.map(o=>o.id===t?{...o,...g}:o))},$=t=>{i(m.filter(g=>g.id!==t))},w=(t,g)=>{const o=m.findIndex(K=>K.id===t);if(o===-1)return;const d=[...m];g==="up"&&o>0?[d[o],d[o-1]]=[d[o-1],d[o]]:g==="down"&&o<m.length-1&&([d[o],d[o+1]]=[d[o+1],d[o]]),d.forEach((K,ce)=>{K.order=ce+1}),i(d)},n=()=>{E(""),M(""),i([]),A(!0)},I=async t=>{if(t.preventDefault(),!S.trim()){C({title:"필수 입력",description:"워크플로우 이름을 입력해주세요.",variant:"destructive"});return}if(m.length===0){C({title:"단계 필요",description:"최소 하나의 워크플로우 단계를 추가해주세요.",variant:"destructive"});return}if(m.filter(d=>!d.email.trim()).length>0){C({title:"이메일 필수",description:"모든 단계에 이메일을 입력해주세요.",variant:"destructive"});return}const o=u();if(!o){C({title:"인증 오류",description:"로그인이 필요합니다.",variant:"destructive"});return}await D.mutateAsync({name:S.trim(),description:T.trim()||void 0,createdBy:o,steps:{isSequential:k,steps:m.map(d=>{var K;return{type:d.type,email:d.email.trim(),name:((K=d.name)==null?void 0:K.trim())||void 0,order:d.order,isRequired:d.isRequired,allowParallel:d.allowParallel,deadline:d.deadline||void 0}})}})},q=t=>{switch(t){case"signer":return e.jsx(_e,{className:"h-4 w-4"});case"approver":return e.jsx(Oe,{className:"h-4 w-4"});case"reviewer":return e.jsx(z,{className:"h-4 w-4"});default:return e.jsx(Ke,{className:"h-4 w-4"})}},F=t=>{switch(t){case"signer":return"bg-blue-100 text-blue-800";case"approver":return"bg-green-100 text-green-800";case"reviewer":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return e.jsx(qe,{open:r,onOpenChange:l,children:e.jsxs(Fe,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Me,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"협업 워크플로우 생성"]})}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"workflowName",children:"워크플로우 이름"}),e.jsx(_,{id:"workflowName",value:S,onChange:t=>E(t.target.value),placeholder:"예: 계약서 승인 워크플로우",required:!0})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{id:"sequential",checked:k,onCheckedChange:A}),e.jsx(v,{htmlFor:"sequential",children:"순차 실행"})]})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"workflowDescription",children:"설명 (선택사항)"}),e.jsx(Ie,{id:"workflowDescription",value:T,onChange:t=>M(t.target.value),placeholder:"워크플로우에 대한 설명을 입력하세요...",rows:3})]}),e.jsx(he,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"워크플로우 단계"}),e.jsxs(x,{type:"button",onClick:W,size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"단계 추가"]})]}),m.length===0?e.jsx(y,{className:"border-dashed",children:e.jsxs(b,{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(z,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsxs("p",{className:"text-gray-500 text-center",children:["아직 워크플로우 단계가 없습니다.",e.jsx("br",{}),'"단계 추가" 버튼을 클릭하여 시작하세요.']})]})}):e.jsx("div",{className:"space-y-3",children:m.map((t,g)=>e.jsxs(y,{className:"relative",children:[e.jsx(O,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(P,{className:F(t.type),children:[q(t.type),e.jsxs("span",{className:"ml-1",children:["단계 ",t.order]})]}),e.jsxs(ae,{value:t.type,onValueChange:o=>f(t.id,{type:o}),children:[e.jsx(re,{className:"w-32",children:e.jsx(ie,{})}),e.jsxs(ne,{children:[e.jsx(p,{value:"signer",children:"서명자"}),e.jsx(p,{value:"approver",children:"승인자"}),e.jsx(p,{value:"reviewer",children:"검토자"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(x,{type:"button",variant:"ghost",size:"sm",onClick:()=>w(t.id,"up"),disabled:g===0,children:e.jsx(ps,{className:"h-4 w-4"})}),e.jsx(x,{type:"button",variant:"ghost",size:"sm",onClick:()=>w(t.id,"down"),disabled:g===m.length-1,children:e.jsx(us,{className:"h-4 w-4"})}),e.jsx(x,{type:"button",variant:"ghost",size:"sm",onClick:()=>$(t.id),children:e.jsx(Qe,{className:"h-4 w-4 text-red-500"})})]})]})}),e.jsxs(b,{className:"pt-0",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{children:"이메일"}),e.jsx(_,{value:t.email,onChange:o=>f(t.id,{email:o.target.value}),placeholder:"user@example.com",type:"email",required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{children:"이름 (선택사항)"}),e.jsx(_,{value:t.name||"",onChange:o=>f(t.id,{name:o.target.value}),placeholder:"홍길동"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{checked:t.isRequired,onCheckedChange:o=>f(t.id,{isRequired:o})}),e.jsx(v,{className:"text-sm",children:"필수 단계"})]}),!k&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ee,{checked:t.allowParallel,onCheckedChange:o=>f(t.id,{allowParallel:o})}),e.jsx(v,{className:"text-sm",children:"병렬 실행 허용"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-gray-500"}),e.jsxs(ae,{value:t.deadline||"",onValueChange:o=>f(t.id,{deadline:o||void 0}),children:[e.jsx(re,{className:"w-32",children:e.jsx(ie,{placeholder:"마감일"})}),e.jsxs(ne,{children:[e.jsx(p,{value:"",children:"마감일 없음"}),e.jsx(p,{value:"1",children:"1일"}),e.jsx(p,{value:"3",children:"3일"}),e.jsx(p,{value:"7",children:"1주"}),e.jsx(p,{value:"14",children:"2주"}),e.jsx(p,{value:"30",children:"1개월"})]})]})]})]})]})]},t.id))})]}),e.jsx(he,{}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:D.isPending,children:"취소"}),e.jsx(x,{type:"submit",disabled:D.isPending,className:"bg-primary hover:bg-primary/90",children:D.isPending?"생성 중...":"워크플로우 생성"})]})]})]})})}function et({document:s,open:r,onOpenChange:l}){const{user:c}=Ze(),[u,S]=h.useState(""),[E,T]=h.useState(""),[M,m]=h.useState(""),[i,k]=h.useState(void 0),[A,C]=h.useState(!1),[D,W]=h.useState(1),[f,$]=h.useState("none"),[w,n]=h.useState(""),[I,q]=h.useState(!1),{toast:F}=xe(),{data:t=[]}=V({queryKey:["/api/workflow-templates"],queryFn:async()=>{const a=c==null?void 0:c.id;if(!a)throw new Error("로그인이 필요합니다");const j=await We(`/api/workflow-templates?userId=${a}`);if(!j.ok)throw new Error("템플릿을 가져올 수 없습니다");return j.json()}}),g=se({mutationFn:async a=>{const j=await fetch("/api/signature-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!j.ok)throw new Error("서명 요청 전송에 실패했습니다");return j.json()},onSuccess:()=>{F({title:"서명 요청 전송 완료",description:"서명자에게 이메일로 요청이 전송되었습니다."}),G.invalidateQueries({queryKey:["/api/signature-requests",s.id]}),l(!1),d()},onError:a=>{F({title:"서명 요청 실패",description:a.message||"서명 요청 중 오류가 발생했습니다.",variant:"destructive"})}}),o=se({mutationFn:async a=>{const j=await fetch("/api/workflows/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!j.ok)throw new Error("워크플로우 생성에 실패했습니다");return j.json()},onSuccess:()=>{F({title:"워크플로우 시작",description:"협업 워크플로우가 성공적으로 시작되었습니다."}),G.invalidateQueries({queryKey:["/api/signature-requests",s.id]}),l(!1),d()},onError:a=>{F({title:"워크플로우 생성 실패",description:a.message||"워크플로우 생성 중 오류가 발생했습니다.",variant:"destructive"})}}),d=()=>{S(""),T(""),m(""),k(void 0),C(!1),W(1),$("none"),n("")},K=async a=>{if(a.preventDefault(),!u.trim()){F({title:"필수 입력",description:"서명자 이메일을 입력해주세요.",variant:"destructive"});return}let j=i;if(f!=="none"&&f!=="custom"){const R=f==="3days"?3:f==="1week"?7:f==="2weeks"?14:30;j=new Date,j.setDate(j.getDate()+R)}try{await g.mutateAsync({documentId:s.id,requesterId:(c==null?void 0:c.id)||0,signerEmail:u.trim(),signerName:E.trim()||void 0,message:M.trim()||void 0,deadline:j,isSequential:A,signatureOrder:D})}catch(R){console.error("Signature request error:",R)}},ce=async()=>{if(!w){F({title:"템플릿 선택 필요",description:"워크플로우 템플릿을 선택해주세요.",variant:"destructive"});return}try{await o.mutateAsync({templateId:parseInt(w),documentId:s.id,requesterId:(c==null?void 0:c.id)||0})}catch(a){console.error("Workflow creation error:",a)}},je=a=>{switch(a){case"signer":return e.jsx(_e,{className:"h-4 w-4"});case"approver":return e.jsx(Oe,{className:"h-4 w-4"});case"reviewer":return e.jsx(z,{className:"h-4 w-4"});default:return e.jsx(Ke,{className:"h-4 w-4"})}},pe=a=>{switch(a){case"signer":return"bg-blue-100 text-blue-800";case"approver":return"bg-green-100 text-green-800";case"reviewer":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs(e.Fragment,{children:[e.jsx(qe,{open:r,onOpenChange:l,children:e.jsxs(Fe,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Me,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5"}),"서명 요청 및 협업 워크플로우"]})}),e.jsxs(ns,{defaultValue:"single",className:"w-full",children:[e.jsxs(ls,{className:"grid w-full grid-cols-2",children:[e.jsx(ke,{value:"single",children:"단일 서명 요청"}),e.jsx(ke,{value:"workflow",children:"협업 워크플로우"})]}),e.jsx(Ce,{value:"single",className:"space-y-6",children:e.jsxs(y,{children:[e.jsxs(O,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-5 w-5"}),"단일 서명 요청"]}),e.jsx(Se,{children:"한 명의 서명자에게 서명 요청을 보냅니다."})]}),e.jsx(b,{children:e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"문서"}),e.jsx("div",{className:"font-semibold",children:s.title})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"signerEmail",children:"서명자 이메일"}),e.jsx(_,{id:"signerEmail",type:"email",value:u,onChange:a=>S(a.target.value),placeholder:"signer@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"signerName",children:"서명자 이름 (선택사항)"}),e.jsx(_,{id:"signerName",value:E,onChange:a=>T(a.target.value),placeholder:"홍길동"})]})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"message",children:"메시지 (선택사항)"}),e.jsx(Ie,{id:"message",value:M,onChange:a=>m(a.target.value),placeholder:"서명 요청에 대한 추가 메시지를 입력하세요...",rows:3})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(v,{children:"서명 마감일"}),e.jsxs(ae,{value:f,onValueChange:$,children:[e.jsx(re,{children:e.jsx(ie,{placeholder:"마감일 설정"})}),e.jsxs(ne,{children:[e.jsx(p,{value:"none",children:"마감일 없음"}),e.jsx(p,{value:"3days",children:"3일 후"}),e.jsx(p,{value:"1week",children:"1주일 후"}),e.jsx(p,{value:"2weeks",children:"2주일 후"}),e.jsx(p,{value:"1month",children:"1개월 후"}),e.jsx(p,{value:"custom",children:"직접 선택"})]})]}),f==="custom"&&e.jsxs(as,{children:[e.jsx(rs,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[e.jsx(os,{className:"mr-2 h-4 w-4"}),i?ts(i,"PPP",{locale:Qs}):"날짜 선택"]})}),e.jsx(is,{className:"w-auto p-0",children:e.jsx(Ge,{mode:"single",selected:i,onSelect:k,disabled:a=>a<new Date,initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(v,{className:"text-sm font-medium",children:"순차 서명"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"여러 서명자가 있을 때 순서대로 서명하도록 설정"})]}),e.jsx(ee,{checked:A,onCheckedChange:C})]}),A&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(v,{htmlFor:"signatureOrder",children:"서명 순서"}),e.jsx(_,{id:"signatureOrder",type:"number",min:"1",value:D,onChange:a=>W(parseInt(a.target.value))})]})})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:g.isPending,children:"취소"}),e.jsx(x,{type:"submit",disabled:g.isPending,className:"bg-primary hover:bg-primary/90",children:g.isPending?"전송 중...":"서명 요청 보내기"})]})]})})]})}),e.jsx(Ce,{value:"workflow",className:"space-y-6",children:e.jsxs(y,{children:[e.jsxs(O,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5"}),"협업 워크플로우"]}),e.jsx(Se,{children:"미리 정의된 템플릿을 사용하여 복잡한 서명 및 승인 프로세스를 관리합니다."})]}),e.jsxs(b,{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"문서"}),e.jsx("div",{className:"font-semibold",children:s.title})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(v,{children:"워크플로우 템플릿 선택"}),e.jsxs(x,{type:"button",variant:"outline",size:"sm",onClick:()=>q(!0),children:[e.jsx(te,{className:"h-4 w-4 mr-1"}),"새 템플릿 만들기"]})]}),t.length===0?e.jsxs(de,{children:[e.jsx(ds,{className:"h-4 w-4"}),e.jsx(me,{children:"사용 가능한 워크플로우 템플릿이 없습니다. 새 템플릿을 만들어 보세요."})]}):e.jsx("div",{className:"grid grid-cols-1 gap-3",children:t.map(a=>{var j,R,N,X,ge,fe,ve;return e.jsx(y,{className:`cursor-pointer transition-all ${w===a.id.toString()?"ring-2 ring-primary border-primary":"hover:shadow-md"}`,onClick:()=>n(a.id.toString()),children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:a.name}),a.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[((R=(j=a.steps)==null?void 0:j.steps)==null?void 0:R.length)||0,"개 단계"]}),e.jsx(P,{variant:"outline",className:"text-xs",children:(N=a.steps)!=null&&N.isSequential?"순차 실행":"병렬 실행"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[(ge=(X=a.steps)==null?void 0:X.steps)==null?void 0:ge.slice(0,3).map((we,$e)=>e.jsx(P,{className:`text-xs ${pe(we.type)}`,children:je(we.type)},$e)),((ve=(fe=a.steps)==null?void 0:fe.steps)==null?void 0:ve.length)>3&&e.jsxs(P,{variant:"outline",className:"text-xs",children:["+",a.steps.steps.length-3]})]})]})})},a.id)})})]}),w&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(v,{children:"선택된 워크플로우 미리보기"}),(()=>{var j,R;const a=t.find(N=>N.id.toString()===w);return a?e.jsx(y,{className:"bg-blue-50 border-blue-200",children:e.jsxs(b,{className:"p-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:a.name}),e.jsx("div",{className:"space-y-2",children:(R=(j=a.steps)==null?void 0:j.steps)==null?void 0:R.map((N,X)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white rounded",children:[e.jsxs(P,{className:pe(N.type),children:[je(N.type),e.jsxs("span",{className:"ml-1",children:["단계 ",N.order]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium",children:N.email}),N.name&&e.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",N.name,")"]})]}),N.deadline&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Y,{className:"h-3 w-3"}),N.deadline,"일"]})]},X))})]})}):null})()]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:o.isPending,children:"취소"}),e.jsx(x,{onClick:ce,disabled:o.isPending||!w,className:"bg-primary hover:bg-primary/90",children:o.isPending?"시작 중...":"워크플로우 시작"})]})]})]})})]})]})}),e.jsx(Gs,{documentId:s.id,open:I,onOpenChange:q,onWorkflowCreated:a=>{G.invalidateQueries({queryKey:["/api/workflow-templates"]})}})]})}function $t(){const{user:s}=Ye(),[r,l]=h.useState(null),[c,u]=h.useState(!1),[S,E]=h.useState(!1),[T,M]=h.useState(null),[m,i]=h.useState(""),[k,A]=h.useState("all"),{data:C=[]}=V({queryKey:["/api/documents"],queryFn:async()=>{const n=await fetch(`/api/documents?userId=${s==null?void 0:s.id}`);if(!n.ok)throw new Error("문서를 가져올 수 없습니다");return n.json()},enabled:!!s}),D=C.filter(n=>{const I=n.title.toLowerCase().includes(m.toLowerCase()),q=k==="all"||n.status===k;return I&&q}),W=n=>{switch(n){case"서명 완료":return e.jsxs(P,{className:"bg-green-100 text-green-800",children:[e.jsx(De,{className:"w-3 h-3 mr-1"}),"완료"]});case"서명 대기":return e.jsxs(P,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"대기"]});case"업로드됨":return e.jsx(P,{variant:"outline",className:"bg-blue-100 text-blue-800",children:"업로드됨"});default:return e.jsx(P,{variant:"outline",children:n})}},f=n=>{M(n),E(!0)},$=n=>{l(n)},w=(n,I="pdf",q={})=>{const F=new URLSearchParams({format:I,signatures:q.includeSignatures?"true":"false",audit:q.includeAuditTrail?"true":"false",blockchain:q.includeBlockchainProof?"true":"false"}),t=globalThis.document.createElement("a");t.href=`/api/documents/${n.id}/download?${F}`,t.download=`${n.title}.${I}`,t.click()};return r?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ye,{}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-6",children:e.jsx(x,{variant:"outline",onClick:()=>l(null),className:"mb-4",children:"← 문서 목록으로 돌아가기"})}),e.jsx(Xs,{document:r})]})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ye,{}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"문서 관리"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"블록체인으로 보호되는 안전한 전자문서 관리"})]}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsxs(x,{onClick:()=>u(!0),className:"bg-primary hover:bg-primary/90",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"문서 업로드"]})})]})}),e.jsx(y,{className:"mb-6",children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ms,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(_,{placeholder:"문서명으로 검색...",value:m,onChange:n=>i(n.target.value),className:"pl-10"})]})}),e.jsx("div",{className:"w-full sm:w-48",children:e.jsxs(ae,{value:k,onValueChange:A,children:[e.jsxs(re,{children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),e.jsx(ie,{placeholder:"상태 필터"})]}),e.jsxs(ne,{children:[e.jsx(p,{value:"all",children:"모든 상태"}),e.jsx(p,{value:"업로드됨",children:"업로드됨"}),e.jsx(p,{value:"서명 대기",children:"서명 대기"}),e.jsx(p,{value:"서명 완료",children:"서명 완료"})]})]})})]})})}),D.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(n=>e.jsx(y,{className:"hover:shadow-md transition-shadow",children:e.jsxs(b,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:n.title}),e.jsx("p",{className:"text-sm text-gray-500",children:n.fileType})]})]}),W(n.status)]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"업로드일:"}),e.jsx("span",{children:n.createdAt?new Date(n.createdAt).toLocaleDateString("ko-KR"):""})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"크기:"}),e.jsx("span",{children:n.fileSize?`${Math.round(n.fileSize/1024)} KB`:"N/A"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>$(n),className:"flex-1",children:[e.jsx(cs,{className:"w-3 h-3 mr-1"}),"보기"]}),e.jsxs(He,{children:[e.jsx(Le,{asChild:!0,children:e.jsx(x,{size:"sm",variant:"outline",children:e.jsx(Te,{className:"w-3 h-3"})})}),e.jsxs(ze,{align:"end",children:[e.jsxs(J,{onClick:()=>w(n,"pdf",{includeSignatures:!0,includeBlockchainProof:!0}),children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"PDF (서명 포함)"]}),e.jsxs(J,{onClick:()=>w(n,"pdf",{includeSignatures:!1}),children:[e.jsx(vs,{className:"w-4 h-4 mr-2"}),"PDF (원본만)"]}),e.jsx(Ue,{}),e.jsxs(J,{onClick:()=>w(n,"json",{includeSignatures:!0,includeAuditTrail:!0,includeBlockchainProof:!0}),children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"JSON 데이터"]}),e.jsxs(J,{onClick:()=>w(n,"xml",{includeSignatures:!0,includeAuditTrail:!0,includeBlockchainProof:!0}),children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"XML 데이터"]})]})]}),n.status!=="서명 완료"&&e.jsx(x,{size:"sm",variant:"outline",onClick:()=>f(n),children:e.jsx(Ae,{className:"w-3 h-3"})})]})]})},n.id))}):e.jsx(y,{children:e.jsxs(b,{className:"p-12 text-center",children:[e.jsx(Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"문서가 없습니다"}),e.jsx("p",{className:"text-gray-500 mb-6",children:m||k!=="all"?"검색 조건에 맞는 문서가 없습니다.":"첫 번째 문서를 업로드해보세요."}),e.jsxs(x,{onClick:()=>u(!0),children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"문서 업로드"]})]})})]}),e.jsx(es,{open:c,onOpenChange:u}),T&&e.jsx(et,{document:T,open:S,onOpenChange:E})]})}export{$t as default};
